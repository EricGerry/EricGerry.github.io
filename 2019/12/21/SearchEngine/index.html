<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    
    
        
            
                <link rel="shortcut icon" href="/images/favicon.ico">
            
        
        
            
                <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
            
        
        
            
                <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
            
        
    
    <!-- title -->
    <title>SearchEngine</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+SC&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@2/distr/fira_code.css" rel="stylesheet">
    <!-- rss -->
    
    
        <link rel="alternate" href="/true" title="TheOak" type="application/atom+xml"/>
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">

    <div id="header-post">
    <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
    <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
    <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i
                class="fas fa-chevron-up fa-lg"></i></a>
    <span id="menu">
    <span id="nav">
      <ul>
          
              <li><a href="/">Home</a></li>
          
              <li><a href="/archives/">Articles</a></li>
          
              <li><a href="/categories/">Category</a></li>
          
              <li><a href="/tags/">Tag</a></li>
          
              <li><a href="/about/">About</a></li>
          
              <li><a href="/search/">Search</a></li>
          
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
          
              <li><a class="icon" href="/2020/01/08/%E5%B8%B8%E7%94%A8%E7%9A%84%E5%87%A0%E7%A7%8D%E6%8E%92%E5%BA%8F%E4%BD%A0%E5%AD%A6%E4%BC%9A%E4%BA%86%E5%90%97%EF%BC%9F/"><i class="fas fa-chevron-left"
                                                                           aria-hidden="true"
                                                                           onmouseover="$('#i-prev').toggle();"
                                                                           onmouseout="$('#i-prev').toggle();"></i></a></li>
          
          
              <li><a class="icon" href="/2019/12/04/HashMap%E5%92%8CTreeMap%E5%AF%B9%E6%AF%94/"><i class="fas fa-chevron-right"
                                                                           aria-hidden="true"
                                                                           onmouseover="$('#i-next').toggle();"
                                                                           onmouseout="$('#i-next').toggle();"></i></a></li>
          
          <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i
                          class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();"
                          onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true"
                                        onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();"
                                        onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
    <li><a class="icon"
           href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://theoak.online/2019/12/21/SearchEngine/&title=SearchEngine"><i
                    class="fab fa-qq " aria-hidden="true"></i></a></li>
    <li><a class="icon"
           href="https://service.weibo.com/share/share.php?url=http://theoak.online/2019/12/21/SearchEngine/&title=SearchEngine"><i
                    class="fab fa-weibo " aria-hidden="true"></i></a></li>
    <li><a class="icon" href="https://twitter.com/share?url=http://theoak.online/2019/12/21/SearchEngine/&text=SearchEngine" target="_blank" rel="noopener"><i
                    class="fab fa-twitter " aria-hidden="true"></i></a></li>
    <li><a class="icon" href="mailto:?subject=SearchEngine&body=Check out this article: http://theoak.online/2019/12/21/SearchEngine/"><i
                    class="fas fa-envelope " aria-hidden="true"></i></a></li>
</ul>
    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、搜索引擎"><span class="toc-number">1.</span> <span class="toc-text">一、搜索引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、搜索引擎应该有什么"><span class="toc-number">2.</span> <span class="toc-text">二、搜索引擎应该有什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、Java-API文档"><span class="toc-number">3.</span> <span class="toc-text">三、Java API文档</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）预处理模块"><span class="toc-number">3.1.</span> <span class="toc-text">（1）预处理模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）索引模块"><span class="toc-number">3.2.</span> <span class="toc-text">（2）索引模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）搜索模块"><span class="toc-number">3.3.</span> <span class="toc-text">（3）搜索模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（4）展示模式"><span class="toc-number">3.4.</span> <span class="toc-text">（4）展示模式</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

<div class="content index py4">
    
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        
    <h1 class="posttitle" itemprop="name headline">
        SearchEngine
    </h1>

        <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">
            EricGerry
            
        </span>
      </span>
            
    <div class="postdate">
        
            <time datetime="2019-12-21T12:07:30.000Z"
                  itemprop="datePublished">2019-12-21</time>
            
                (Updated:
                <time datetime="2020-10-12T13:40:45.380Z"
                      itemprop="dateModified">2020-10-12</time>)
            
        
    </div>

            
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a> › <a class="category-link" href="/categories/%E9%A1%B9%E7%9B%AE/Http/">Http</a>
    </div>

            
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/java/" rel="tag">java</a>, <a class="tag-link" href="/tags/%E9%A1%B9%E7%9B%AE/" rel="tag">项目</a>
    </div>

        </div>
    </header>
    
    <div class="content" itemprop="articleBody">
        <h2 id="一、搜索引擎"><a href="#一、搜索引擎" class="headerlink" title="一、搜索引擎"></a>一、搜索引擎</h2><blockquote>
<p>所谓搜索引擎，就是根据用户需求与一定算法，运用特定策略从互联网检索出制定信息反馈给用户的一门检索技术。搜索引擎依托于多种技术，如网络爬虫技术、检索排序技术、网页处理技术、大数据处理技术、自然语言处理技术等，为信息检索用户提供快速、高相关性的信息服务。搜索引擎技术的核心模块一般包括爬虫、索引、检索和排序等，同时可添加其他一系列辅助模块，以为用户创造更好的网络使用环境。</p>
</blockquote>
<h2 id="二、搜索引擎应该有什么"><a href="#二、搜索引擎应该有什么" class="headerlink" title="二、搜索引擎应该有什么"></a>二、搜索引擎应该有什么</h2><ul>
<li>1.有一个主页,有搜索框.在搜索框中输入的内容 称为查询词</li>
<li>2.还有搜索结果页,包含了若干条搜索结果</li>
<li>3.针对每一个搜索结果,都会包含查询词或者查询词的一部分或者和查询词有一定的关联性</li>
<li>4.每个搜索结果可能包含好几个部分:<ul>
<li>a）标题</li>
<li>b）描述 通常是页面的摘要信息</li>
<li>c）子链接</li>
<li>d）展示url</li>
<li>e）图片</li>
<li>f）点击url 点击url浏览器将转到“落地页”</li>
</ul>
</li>
</ul>
<p>基于这个简单的了解, 就可以实现Java API文档的搜索引擎的部分了, 不用去网上很多网站去找数据,没那么繁琐,不用去使用爬虫去爬取,只用在网站上下载下本地文档就行,基于文档去实现的搜索引擎功能.</p>
<h2 id="三、Java-API文档"><a href="#三、Java-API文档" class="headerlink" title="三、Java API文档"></a>三、Java API文档</h2><p>前提： 先把Java API 文档下载好,并且好准备一个txt文本.</p>
<p>这个Java API文档的搜索引擎大致分为以下4步.</p>
<ul>
<li>预处理模块</li>
<li>索引模块</li>
<li>搜索模块</li>
<li>展示模块</li>
</ul>
<h3 id="（1）预处理模块"><a href="#（1）预处理模块" class="headerlink" title="（1）预处理模块"></a>（1）预处理模块</h3><p>把所有的Java API文档中html文档进行预处理：所有的文档转为一个行文本文件,每行对应一个原来的html,每一行中有三列,标题 url 去掉标签的正文。这就相当于搜索引擎整合了许多的网页资源,在后台存放.以供搜索</p>
<p>其中在文件中运用递归的方式（listFiles()方法获取文件中的所以子文件）去找到所以得html文档,去处理它,存到开始创建的文本文档中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历文档目录, 读取所有的 html 文档内容, 把结果解析成行文本文件.</span></span><br><span class="line"><span class="comment">// 每一行都对应一个文档. 每一行中都包含 文档标题, 文档的 URL, 文档的正文(去掉 html 标签的内容)</span></span><br><span class="line"><span class="comment">// Parser 是一个单独的可执行的类(带有 main 方法)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parser</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 下载好的 Java API 文档在哪</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INPUT_PATH = <span class="string">"E:\\jdk1.8\\docs\\api"</span>;</span><br><span class="line">    <span class="comment">// 预处理模块输出文件存放的目录</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String OUTPUT_PATH = <span class="string">"E:\\raw_data.txt"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileWriter resultFileWriter = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(OUTPUT_PATH));</span><br><span class="line">        <span class="comment">// 通过 main 完成整个预处理的过程</span></span><br><span class="line">        <span class="comment">// 1. 枚举出 INPUT_PATH 下所有的 html 文件(递归)</span></span><br><span class="line">        ArrayList&lt;File&gt; fileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        enumFile(INPUT_PATH, fileList);</span><br><span class="line">        <span class="comment">// 2. 针对枚举出来的html文件路径进行遍历, 依次打开每个文件, 并读取内容.</span></span><br><span class="line">        <span class="comment">//    把内容转换成需要的结构化的数据(DocInfo对象)</span></span><br><span class="line">        <span class="keyword">for</span> (File f : fileList) &#123;</span><br><span class="line">            System.out.println(<span class="string">"converting "</span> + f.getAbsolutePath() + <span class="string">" ..."</span>);</span><br><span class="line">            <span class="comment">// 最终输出的 raw_data 文件是一个行文本文件. 每一行对应一个 html 文件.</span></span><br><span class="line">            <span class="comment">// line 这个对象就对应到一个文件.</span></span><br><span class="line">            String line = convertLine(f);</span><br><span class="line">            <span class="comment">// 3. 把得到的结果写入到最终的输出文件中(OUTPUT_PATH). 写成行文本的形式</span></span><br><span class="line">            resultFileWriter.write(line);</span><br><span class="line">        &#125;</span><br><span class="line">        resultFileWriter.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处咱们的 raw_data 文件使用行文本来表示只是一种方式而已.</span></span><br><span class="line">    <span class="comment">// 完全也可以使用 json 或者 xml 或者其他任何你喜欢的方式来表示都行</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertLine</span><span class="params">(File f)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 1. 根据 f 转换出 标题</span></span><br><span class="line">        String title = convertTitle(f);</span><br><span class="line">        <span class="comment">// 2. 根据 f 转换出 url</span></span><br><span class="line">        String url = convertUrl(f);</span><br><span class="line">        <span class="comment">// 3. 根据 f 转换成正文, a) 去掉 html 标签; b) 去掉换行符</span></span><br><span class="line">        String content = convertContent(f);</span><br><span class="line">        <span class="comment">// 4. 把这三个部分拼成一行文本</span></span><br><span class="line">        <span class="comment">//    \3 起到分割三个部分的效果. \3 ASCII 值为 3 的字符</span></span><br><span class="line">        <span class="comment">//    在一个 html 这样的文本文件中是不会存在 \3 这种不可见字符</span></span><br><span class="line">        <span class="comment">//    类似的, 使用 \1 \2 \4 \5....来分割效果也是一样</span></span><br><span class="line">        <span class="keyword">return</span> title + <span class="string">"\3"</span> + url + <span class="string">"\3"</span> + content + <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertContent</span><span class="params">(File f)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 这个方法做两件事情:</span></span><br><span class="line">        <span class="comment">// 1. 把 html 中的标签去掉</span></span><br><span class="line">        <span class="comment">// 2. 把 \n 也去掉</span></span><br><span class="line">        <span class="comment">// 一个一个字符读取并判定</span></span><br><span class="line">        FileReader fileReader = <span class="keyword">new</span> FileReader(f);</span><br><span class="line">        <span class="keyword">boolean</span> isContent = <span class="keyword">true</span>;</span><br><span class="line">        StringBuilder output = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> ret = fileReader.read();</span><br><span class="line">            <span class="keyword">if</span> (ret == -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// 读取完毕了</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">char</span> c = (<span class="keyword">char</span>)ret;</span><br><span class="line">            <span class="keyword">if</span> (isContent) &#123;</span><br><span class="line">                <span class="comment">// 当前这部分内容是正文</span></span><br><span class="line">                <span class="keyword">if</span> (c == <span class="string">'&lt;'</span>) &#123;</span><br><span class="line">                    isContent = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (c == <span class="string">'\n'</span> || c == <span class="string">'\r'</span>) &#123;</span><br><span class="line">                    c = <span class="string">' '</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                output.append(c);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 当前这个部分内容是标签</span></span><br><span class="line">                <span class="comment">// 不去写 output</span></span><br><span class="line">                <span class="keyword">if</span> (c == <span class="string">'&gt;'</span>) &#123;</span><br><span class="line">                    isContent = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        fileReader.close();</span><br><span class="line">        <span class="keyword">return</span> output.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertUrl</span><span class="params">(File f)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// URL 线上文档对应的 URL</span></span><br><span class="line">        <span class="comment">// 线上文档 URL 形如:</span></span><br><span class="line">        <span class="comment">// https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html</span></span><br><span class="line">        <span class="comment">// 本地目录文档路径形如:</span></span><br><span class="line">        <span class="comment">// D:\jdk1.8\docs\api\java/util\Collection.html</span></span><br><span class="line">        <span class="comment">// 线上文档的 URL 由两个部分构成.</span></span><br><span class="line">        <span class="comment">// part1: https://docs.oracle.com/javase/8/docs/api  固定的</span></span><br><span class="line">        <span class="comment">// part2: /java/util/Collection.html 和本地文件的路径密切相关.</span></span><br><span class="line">        <span class="comment">// 此处对于 浏览器 来说, / 或者 \ 都能识别.</span></span><br><span class="line">        String part1 = <span class="string">"https://docs.oracle.com/javase/8/docs/api"</span>;</span><br><span class="line">        String part2 = f.getAbsolutePath().substring(INPUT_PATH.length());</span><br><span class="line">        <span class="keyword">return</span> part1 + part2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertTitle</span><span class="params">(File f)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 把文件名(不是全路径, 去掉.html后缀)作为标题就可以了</span></span><br><span class="line">        <span class="comment">// 文件名: EntityResolver.html</span></span><br><span class="line">        <span class="comment">// 全路径: D:\jdk1.8\docs\api\org\xml\sax\EntityResolver.html</span></span><br><span class="line">        String name = f.getName();</span><br><span class="line">        <span class="keyword">return</span> name.substring(<span class="number">0</span>, name.length() - <span class="string">".html"</span>.length());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当这个方法递归完毕后, 当前 inputPath 目录下所有子目录中的 html 的路径就都被收集到</span></span><br><span class="line">    <span class="comment">// fileList 这个 List 中了</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">enumFile</span><span class="params">(String inputPath, ArrayList&lt;File&gt; fileList)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 递归的把 inputPath 对应的全部目录和文件都遍历一遍</span></span><br><span class="line">        File root = <span class="keyword">new</span> File(inputPath);</span><br><span class="line">        <span class="comment">// listFiles 相当于 Linux 上的 ls 命令.</span></span><br><span class="line">        <span class="comment">// 就把当前目录下所有的文件和目录都罗列出来了. 当前目录就是 root 对象所对应的目录</span></span><br><span class="line">        File[] files = root.listFiles();</span><br><span class="line">        <span class="comment">// System.out.println(Arrays.toString(files));</span></span><br><span class="line">        <span class="comment">// 遍历当前这些目录和文件路径, 分别处理</span></span><br><span class="line">        <span class="keyword">for</span> (File f : files) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f.isDirectory()) &#123;</span><br><span class="line">                <span class="comment">// 如果当前这个 f 是一个目录. 递归调用 enumFile</span></span><br><span class="line">                enumFile(f.getAbsolutePath(), fileList);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f.getAbsolutePath().endsWith(<span class="string">".html"</span>)) &#123;</span><br><span class="line">                <span class="comment">// 如果当前 f 不是一个目录, 看文件后缀是不是 .html. 如果是就把这个文件的对象</span></span><br><span class="line">                <span class="comment">// 加入到 fileList 这个 List 中</span></span><br><span class="line">                fileList.add(f);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="（2）索引模块"><a href="#（2）索引模块" class="headerlink" title="（2）索引模块"></a>（2）索引模块</h3><p>根据预处理得到的结果来构建正排+倒排索引,</p>
<p>正排索引和倒排索引是撒？为什么要用呢？</p>
<blockquote>
<p>当前搜索引擎后台获取了很多很多的网页数据,每一个网页数据都是一个html,称为文档/Document,想要知道查询词在哪些文档出现过,许多人想那不是暴力搜索就OK了？<br>但是文档数目太多,依次遍历的话效率就非常的低,所以就出现了倒排索引（一种特殊的数据结构）</p>
</blockquote>
<p>也就是根据正排索引去构建倒排索引来看个图就行了<br><img src="/2019/12/21/SearchEngine/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95.jpg" alt=" "></p>
<p>这个图片中可以看到把文档中的内容先有一个唯一ID标识文档,然后把文档内容进行分词然后统计在哪一个文档中出现了,并记录下来,这就是倒排索引.有了这个倒排索引,找到搜索结果也就更加方便了</p>
<p>构建的过程大概是这么实现的,肯定得先<strong>构建正排索引</strong>:<br>我们为正排索引建一个DocInfo类存放每个文档的具体信息,直接读取之前存放所有信息的文档,给DocInfo对象数组中存放好所有的信息,<br>然后<strong>构建倒排索引</strong>：<br>定义一个内部类去存放文档分词后的出现权重,对标题和正文统计,然后对每一个文档进行分词统计,放到一个hashmap中。具体思路就是这样</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> common.DocInfo;</span><br><span class="line"><span class="keyword">import</span> org.ansj.domain.Term;</span><br><span class="line"><span class="keyword">import</span> org.ansj.splitWord.analysis.ToAnalysis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Index</span> </span>&#123;</span><br><span class="line">    <span class="comment">// word 这个词在 docId 文档中对应的权重是多少</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Weight</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> String word;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> docId;</span><br><span class="line">        <span class="comment">// weight 生成公式: 10 * 标题中出现的次数 + 正文中出现的次数</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> weight;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 索引类需要包含两方面的内容. 正排索引, 倒排索引</span></span><br><span class="line">    <span class="comment">// 正排索引是 docId =&gt; DocInfo 直接把 docId 作为数组下标就行了</span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;DocInfo&gt; forwardIndex = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">// 倒排索引 词 =&gt; 一组 docId</span></span><br><span class="line">    <span class="comment">// 不光能得到每个词在哪些文档中出现过, 还想知道这个词在该文档中的权重是多少.</span></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String, ArrayList&lt;Weight&gt;&gt; invertedIndex = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Index 类需要提供的方法</span></span><br><span class="line">    <span class="comment">// 查正排</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DocInfo <span class="title">getDocInfo</span><span class="params">(<span class="keyword">int</span> docId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> forwardIndex.get(docId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查倒排</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Weight&gt; <span class="title">getInverted</span><span class="params">(String term)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> invertedIndex.get(term);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构建索引, 把 raw_data.txt 文件内容读取出来, 加载到内存上面的数据结构中</span></span><br><span class="line">    <span class="comment">// raw_data.txt 是一个行文本文件. 每一行都有三个部分. 每个部分之间使用 \3 分割</span></span><br><span class="line">    <span class="comment">// 索引模块中最复杂的部分</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(String inputPath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Timer</span> </span>&#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">long</span> readFileTime;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">long</span> buildForwardTime;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">long</span> buildInvertedTime;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">long</span> logTime;</span><br><span class="line">        &#125;</span><br><span class="line">        Timer timer = <span class="keyword">new</span> Timer();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">"build start!"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. 打开文件, 并且按行读取文件内容</span></span><br><span class="line">        BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="keyword">new</span> File(inputPath)));</span><br><span class="line">        <span class="comment">// 2. 读取到的每一行.</span></span><br><span class="line">        <span class="comment">// 加时间是有技巧的. 不应该在比较大的循环中加入过多的打印信息. 打印信息会很多, 看起来很不方便.</span></span><br><span class="line">        <span class="comment">// 打印函数本身也是有时间消耗的.</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">long</span> t1 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">            String line = bufferedReader.readLine();</span><br><span class="line">            <span class="keyword">if</span> (line == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">long</span> t2 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3. 构造正排的过程: 按照 \3 来切分, 切分结果构造成一个 DocInfo 对象, 并加入到正排索引中</span></span><br><span class="line">            DocInfo docInfo = buildForward(line);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">long</span> t3 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4. 构造倒排的过程: 把 DocInfo 对象里面的内容进一步处理, 构造出倒排</span></span><br><span class="line">            buildInverted(docInfo);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">long</span> t4 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// System.out.println("Build " + docInfo.getTitle() + " done!");</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">long</span> t5 = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">            timer.readFileTime += (t2 - t1);</span><br><span class="line">            timer.buildForwardTime += (t3 - t2);</span><br><span class="line">            timer.buildInvertedTime += (t4 - t3);</span><br><span class="line">            timer.logTime += (t5 - t4);</span><br><span class="line">        &#125;</span><br><span class="line">        bufferedReader.close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> finishTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">"build finish! time: "</span> + (finishTime - startTime) + <span class="string">" ms"</span>);</span><br><span class="line">        System.out.println(<span class="string">"readFileTime: "</span> + timer.readFileTime</span><br><span class="line">                + <span class="string">" buildForwardTime: "</span> + timer.buildForwardTime</span><br><span class="line">                + <span class="string">" buildInvertedTime: "</span> + timer.buildInvertedTime</span><br><span class="line">                + <span class="string">" logTime: "</span> + timer.logTime);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">buildInverted</span><span class="params">(DocInfo docInfo)</span> </span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">WordCnt</span> </span>&#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">int</span> titleCount;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">int</span> contentCount;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">WordCnt</span><span class="params">(<span class="keyword">int</span> titleCount, <span class="keyword">int</span> contentCount)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.titleCount = titleCount;</span><br><span class="line">                <span class="keyword">this</span>.contentCount = contentCount;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        HashMap&lt;String, WordCnt&gt; wordCntHashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="comment">// 前 4 个操作都是为了给后面的计算权重做铺垫</span></span><br><span class="line">        <span class="comment">// 针对 DocInfo 中的 title 和 content 进行分词, 再根据分词结果构建出 Weight 对象, 更新倒排索引</span></span><br><span class="line">        <span class="comment">// 1. 先针对标题分词</span></span><br><span class="line">        List&lt;Term&gt; titleTerms = ToAnalysis.parse(docInfo.getTitle()).getTerms();</span><br><span class="line">        <span class="comment">// 2. 遍历分词结果, 统计标题中的每个词出现的次数</span></span><br><span class="line">        <span class="keyword">for</span> (Term term : titleTerms) &#123;</span><br><span class="line">            <span class="comment">// 此处 word 已经是被转成小写了</span></span><br><span class="line">            String word = term.getName();</span><br><span class="line">            WordCnt wordCnt = wordCntHashMap.get(word);</span><br><span class="line">            <span class="keyword">if</span> (wordCnt == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 当前这个词在哈希表中不存在</span></span><br><span class="line">                wordCntHashMap.put(word, <span class="keyword">new</span> WordCnt(<span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 当前这个词已经在哈希表中存在, 直接修改 titleCount 即可</span></span><br><span class="line">                wordCnt.titleCount++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3. 再针对正文分词</span></span><br><span class="line">        List&lt;Term&gt; contentTerms = ToAnalysis.parse(docInfo.getContent()).getTerms();</span><br><span class="line">        <span class="comment">// 4. 遍历分词结果, 统计正文中的每个词出现的次数</span></span><br><span class="line">        <span class="keyword">for</span> (Term term : contentTerms) &#123;</span><br><span class="line">            String word = term.getName();</span><br><span class="line">            WordCnt wordCnt = wordCntHashMap.get(word);</span><br><span class="line">            <span class="keyword">if</span> (wordCnt == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 当前这个词在哈希表中不存在</span></span><br><span class="line">                wordCntHashMap.put(word, <span class="keyword">new</span> WordCnt(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                wordCnt.contentCount++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 5. 遍历 HashMap, 依次构建 Weight 对象并更新倒排索引的映射关系</span></span><br><span class="line">        <span class="keyword">for</span> (HashMap.Entry&lt;String, WordCnt&gt; entry : wordCntHashMap.entrySet()) &#123;</span><br><span class="line">            Weight weight = <span class="keyword">new</span> Weight();</span><br><span class="line">            weight.word = entry.getKey();</span><br><span class="line">            weight.docId = docInfo.getDocId();</span><br><span class="line">            <span class="comment">// weight = 标题中出现次数 * 10 + 正文中出现次数</span></span><br><span class="line">            weight.weight = entry.getValue().titleCount * <span class="number">10</span> + entry.getValue().contentCount;</span><br><span class="line">            <span class="comment">// weight 加入到倒排索引中. 倒排索引是一个 HashMap, value 就是 Weight 构成的 ArrayList</span></span><br><span class="line">            <span class="comment">// 先根据这个词, 找到 HashMap 中对应的这个 ArrayList, 称为 "倒排拉链"</span></span><br><span class="line">            ArrayList&lt;Weight&gt; invertedList = invertedIndex.get(entry.getKey());</span><br><span class="line">            <span class="keyword">if</span> (invertedList == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 当前这个键值对不存在, 就新加入一个键值对就可以了</span></span><br><span class="line">                invertedList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">                invertedIndex.put(entry.getKey(), invertedList);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 到了这一步, invertedIndex 已经是一个合法的 ArrayList 了, 就可以把 weight 直接加入即可</span></span><br><span class="line">            invertedList.add(weight);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> DocInfo <span class="title">buildForward</span><span class="params">(String line)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 把这一行按照 \3 切分</span></span><br><span class="line">        <span class="comment">// 分出来的三个部分就是一个文档的 标题, URL, 正文</span></span><br><span class="line">        String[] tokens = line.split(<span class="string">"\3"</span>);</span><br><span class="line">        <span class="keyword">if</span> (tokens.length != <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="comment">// 发现文件格式有问题~~</span></span><br><span class="line">            <span class="comment">// 当前场景下咱们有 1w 多个文件. 如果某个文件出现格式问题,</span></span><br><span class="line">            <span class="comment">// 不应该让某个问题影响到整体的索引构建</span></span><br><span class="line">            <span class="comment">// 此处我们的处理方式仅仅就是打印了日志.</span></span><br><span class="line">            System.out.println(<span class="string">"文件格式存在问题: "</span> + line);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 把新的 docInfo 插入到 数组末尾.</span></span><br><span class="line">        <span class="comment">// 如果数组是 0 个元素, 新的元素所处在的下标就是 0</span></span><br><span class="line">        DocInfo docInfo = <span class="keyword">new</span> DocInfo();</span><br><span class="line">        <span class="comment">// id 就是正排索引数组下标</span></span><br><span class="line">        docInfo.setDocId(forwardIndex.size());</span><br><span class="line">        docInfo.setTitle(tokens[<span class="number">0</span>]);</span><br><span class="line">        docInfo.setUrl(tokens[<span class="number">1</span>]);</span><br><span class="line">        docInfo.setContent(tokens[<span class="number">2</span>]);</span><br><span class="line">        forwardIndex.add(docInfo);</span><br><span class="line">        <span class="keyword">return</span> docInfo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="（3）搜索模块"><a href="#（3）搜索模块" class="headerlink" title="（3）搜索模块"></a>（3）搜索模块</h3><p>搜索模块：输入的是查询词,输出结果是若干条搜索结果（每个搜索结果中包含标题,描述,URL）</p>
<ul>
<li>1.分词:针对输入的查询词进行分词.</li>
<li>2.触发:遍历分词结果,去索引中找到所有和这个分词结果相关的记录(- -大堆docld)</li>
<li>3.排序:针对相关性高低，进行降序排序</li>
<li>4.包装结果:把刚才的这些docld所对应的DocInfo信息查找到,组装成一一个响应数据</li>
</ul>
<p>在其中运用到了Comparator创建比较强,决定对象中的顺序,将权重最大的排在首位,有这俩种实现方法</p>
<blockquote>
<p>Comparable:让需要被比较的类实现这个接口，重写compareTo方法<br>Comparator:创建一个比较器类,实现这个接口，实现的这个接口内部重写compare方法.</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> common.DocInfo;</span><br><span class="line"><span class="keyword">import</span> index.Index;</span><br><span class="line"><span class="keyword">import</span> org.ansj.domain.Term;</span><br><span class="line"><span class="keyword">import</span> org.ansj.splitWord.analysis.ToAnalysis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeightComparator</span> <span class="keyword">implements</span> <span class="title">Comparator</span>&lt;<span class="title">Index</span>.<span class="title">Weight</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//升序 o1 - o2  降序 o2 - o1</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Index.Weight o1, Index.Weight o2)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 如果 o1 &lt; o2 返回一个 &lt; 0</span></span><br><span class="line">        <span class="comment">// 如果 o1 &gt; o2 返回一个 &gt; 0</span></span><br><span class="line">        <span class="comment">// 如果 o1 == o2 返回 0</span></span><br><span class="line">        <span class="keyword">return</span> o2.weight - o1.weight;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过这个类来完成核心的搜索过程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Searcher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Index index = <span class="keyword">new</span> Index();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Searcher</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        index.build(<span class="string">"E:\\raw_data.txt"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Result&gt; <span class="title">search</span><span class="params">(String query)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1. [分词] 针对查询词进行分词</span></span><br><span class="line">        List&lt;Term&gt; terms = ToAnalysis.parse(query).getTerms();</span><br><span class="line">        <span class="comment">// 2. [触发] 针对查询词的分词结果依次查找倒排索引, 得到一大堆相关的 docId</span></span><br><span class="line">        <span class="comment">// 这个 ArrayList 中就保存 每个分词结果 得到的倒排拉链的整体结果</span></span><br><span class="line">        ArrayList&lt;Index.Weight&gt; allTokenResult = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Term term : terms) &#123;</span><br><span class="line">            <span class="comment">// 此处得到的 word 就已经是全小写的内容了. 索引中的内容也是小写的</span></span><br><span class="line">            String word = term.getName();</span><br><span class="line">            List&lt;Index.Weight&gt; invertedList = index.getInverted(word);</span><br><span class="line">            <span class="keyword">if</span> (invertedList == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 用户输入的这部分词很生僻, 在所有文档中都不存在</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            allTokenResult.addAll(invertedList);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3. [排序] 按照权重进行降序排序</span></span><br><span class="line">        <span class="comment">//    匿名内部类</span></span><br><span class="line">        allTokenResult.sort(<span class="keyword">new</span> WeightComparator());</span><br><span class="line">        <span class="comment">// 4. [包装结果] 根据刚才查找到的 docId 在正排中查找 DocInfo, 包装成 Result 对象</span></span><br><span class="line">        ArrayList&lt;Result&gt; results = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Index.Weight weight : allTokenResult) &#123;</span><br><span class="line">            <span class="comment">// 根据 weight 中包含的 docId 找到对应的 DocInfo 对象</span></span><br><span class="line">            DocInfo docInfo = index.getDocInfo(weight.docId);</span><br><span class="line">            Result result = <span class="keyword">new</span> Result();</span><br><span class="line">            result.setTitle(docInfo.getTitle());</span><br><span class="line">            result.setShowUrl(docInfo.getUrl());</span><br><span class="line">            result.setClickUrl(docInfo.getUrl());</span><br><span class="line">            <span class="comment">// GenDesc 做的事情是从正文中摘取一段摘要信息. 根据当前的这个词, 找到这个词在正文中的位置</span></span><br><span class="line">            <span class="comment">// 再把这个位置周围的文本都获取到. 得到了一个片段</span></span><br><span class="line">            result.setDesc(GenDesc(docInfo.getContent(), weight.word));</span><br><span class="line">            results.add(result);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> results;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这个方法根据当前的词, 提取正文中的一部分内容作为描述.</span></span><br><span class="line">    <span class="comment">// 以下的实现逻辑还是咱们拍脑门出来的.</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">GenDesc</span><span class="params">(String content, String word)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 查找 word 在 content 中出现的位置.</span></span><br><span class="line">        <span class="comment">// word 里内容已经是全小写了. content 里头还是大小写都有.</span></span><br><span class="line">        <span class="keyword">int</span> firstPos = content.toLowerCase().indexOf(word);</span><br><span class="line">        <span class="keyword">if</span> (firstPos == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">// 极端情况下, 某个词只在标题中出现, 而没在正文中出现, 在正文中肯定找不到了</span></span><br><span class="line">            <span class="comment">// 这种情况非常少见, 咱们暂时不考虑</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 从 firstPos 开始往前找 60 个字符, 作为描述开始. 如果前面不足 60 个, 就从正文头部开始;</span></span><br><span class="line">        <span class="keyword">int</span> descBeg = firstPos &lt; <span class="number">60</span> ? <span class="number">0</span> : firstPos - <span class="number">60</span>;</span><br><span class="line">        <span class="comment">// 从描述开始往后找 160 个字符作为整个描述内容. 如果后面不足 160 个, 把剩下的都算上.</span></span><br><span class="line">        <span class="keyword">if</span> (descBeg + <span class="number">160</span> &gt; content.length()) &#123;</span><br><span class="line">            <span class="keyword">return</span> content.substring(descBeg);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> content.substring(descBeg, descBeg + <span class="number">160</span>) + <span class="string">"..."</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="（4）展示模式"><a href="#（4）展示模式" class="headerlink" title="（4）展示模式"></a>（4）展示模式</h3><p>先写一个后端的servlet接口,去响应前端的请求,<br>servlet中主要还是获取到分词后的倒排索引的数组排序后转换为Json字符串的格式响应给前端.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.GsonBuilder;</span><br><span class="line"><span class="keyword">import</span> searcher.Result;</span><br><span class="line"><span class="keyword">import</span> searcher.Searcher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/search"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DocSearcherServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Searcher searcher = <span class="keyword">new</span> Searcher();</span><br><span class="line">    <span class="keyword">private</span> Gson gson = <span class="keyword">new</span> GsonBuilder().create();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DocSearcherServlet</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        resp.setContentType(<span class="string">"application/json; charset=utf-8"</span>);</span><br><span class="line">        String query = req.getParameter(<span class="string">"query"</span>);</span><br><span class="line">        <span class="keyword">if</span> (query == <span class="keyword">null</span> || query.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">            resp.setStatus(<span class="number">404</span>);</span><br><span class="line">            resp.getWriter().write(<span class="string">"query 参数非法"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Result&gt; results = searcher.search(query);</span><br><span class="line">        String respString = gson.toJson(results);</span><br><span class="line">        resp.getWriter().write(respString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">前端代码</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">&lt;html xmlns:v-on=<span class="string">"http://www.w3.org/1999/xhtml"</span> xmlns:v-bind=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;!-- Bootstrap 文档: https:<span class="comment">//v3.bootcss.com/css/ --&gt;</span></span><br><span class="line">    &lt;!-- Vue 文档: https:<span class="comment">//cn.vuejs.org/v2/guide/ --&gt;</span></span><br><span class="line">    &lt;!-- Required meta tags --&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1, shrink-to-fit=no"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Bootstrap CSS --&gt;</span><br><span class="line">    &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"</span> integrity=<span class="string">"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"</span> crossorigin=<span class="string">"anonymous"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;title&gt;Java API 搜索&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        #app &#123;</span><br><span class="line">            margin-left:<span class="number">50</span>px;</span><br><span class="line">            margin-right:<span class="number">50</span>px;</span><br><span class="line">        &#125;</span><br><span class="line">        div button &#123;</span><br><span class="line">            width:<span class="number">100</span>%;</span><br><span class="line">        &#125;</span><br><span class="line">        .row &#123;</span><br><span class="line">            padding-top: <span class="number">10</span>px;</span><br><span class="line">        &#125;</span><br><span class="line">        .col-md-<span class="number">5</span>,.col-md-<span class="number">1</span> &#123;</span><br><span class="line">            padding-left:<span class="number">2</span>;</span><br><span class="line">            padding-right:<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        .title &#123;</span><br><span class="line">            font-size: <span class="number">22</span>px;</span><br><span class="line">        &#125;</span><br><span class="line">        .desc &#123;</span><br><span class="line">            font-size: <span class="number">18</span>px;</span><br><span class="line">        &#125;</span><br><span class="line">        .url &#123;</span><br><span class="line">            font-size: <span class="number">18</span>px;</span><br><span class="line">            color: green;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;div class="row"&gt;我是 logo&lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"row"</span>&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-md-5"</span>&gt;</span><br><span class="line">            &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> placeholder=<span class="string">"请输入关键字"</span> v-model=<span class="string">"query"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-md-1"</span>&gt;</span><br><span class="line">            &lt;button class="btn btn-success" v-on:click="search()"&gt;搜索&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"row"</span> v-<span class="keyword">for</span>=<span class="string">"result in results"</span>&gt;</span><br><span class="line">        &lt;!--用来存放结果--&gt;</span><br><span class="line">        &lt;div class="title"&gt;&lt;a v-bind:href="result.clickUrl"&gt;&#123;&#123;result.title&#125;&#125;&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div class="desc"&gt;&#123;&#123;result.desc&#125;&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div class="url"&gt;&#123;&#123;result.showUrl&#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="https://cdn.jsdelivr.net/npm/vue"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#app"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            query: <span class="string">""</span>,</span><br><span class="line">            results: [ ]</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            search() &#123;</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    url:<span class="string">"/java_doc_searcher/search?query="</span> + <span class="keyword">this</span>.query,</span><br><span class="line">                    type: <span class="string">"get"</span>,</span><br><span class="line">                    context: <span class="keyword">this</span>,</span><br><span class="line">                    success: function(respData, status) &#123;</span><br><span class="line">                        <span class="keyword">this</span>.results = respData;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>到这里基于搜索引擎的Java API文档就编写完了</p>

    </div>
</article>

    <div class="blog-post-comments">
        <section id="comment">
            <div id="valine_container" class="valine_thread"></div>
        </section>
        <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
        <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
        <script>
            var GUEST_INFO = ['nick', 'mail', 'link'];
            var guest_info = 'nick,mail,link'.split(',').filter(function (item) {
                return GUEST_INFO.indexOf(item) > -1
            });
            var notify = 'true' == true;
            var verify = 'false' == true;
            var valine = new Valine();
            valine.init({
                el: '#valine_container',
                notify: notify,
                verify: verify,
                appId: "TEnoeFH0w3atQfEjCMpzfDOm-gzGzoHsz",
                appKey: "8GXwVUi9ebKXuqSFR48rkXtK",
                placeholder: "Just go go",
                pageSize: '10',
                avatar: 'mm',
                lang: 'zh-cn'
            })
        </script>
    </div>

    
        <div id="footer-post-container">
    <div id="footer-post">

        <div id="nav-footer" style="display: none">
            <ul>
                
                    <li><a href="/">Home</a></li>
                
                    <li><a href="/archives/">Articles</a></li>
                
                    <li><a href="/categories/">Category</a></li>
                
                    <li><a href="/tags/">Tag</a></li>
                
                    <li><a href="/about/">About</a></li>
                
                    <li><a href="/search/">Search</a></li>
                
            </ul>
        </div>

        <div id="toc-footer" style="display: none">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、搜索引擎"><span class="toc-number">1.</span> <span class="toc-text">一、搜索引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、搜索引擎应该有什么"><span class="toc-number">2.</span> <span class="toc-text">二、搜索引擎应该有什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、Java-API文档"><span class="toc-number">3.</span> <span class="toc-text">三、Java API文档</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）预处理模块"><span class="toc-number">3.1.</span> <span class="toc-text">（1）预处理模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）索引模块"><span class="toc-number">3.2.</span> <span class="toc-text">（2）索引模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）搜索模块"><span class="toc-number">3.3.</span> <span class="toc-text">（3）搜索模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（4）展示模式"><span class="toc-number">3.4.</span> <span class="toc-text">（4）展示模式</span></a></li></ol></li></ol>
        </div>

        <div id="share-footer" style="display: none">
            <ul>
    <li><a class="icon"
           href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://theoak.online/2019/12/21/SearchEngine/&title=SearchEngine"><i
                    class="fab fa-qq fa-lg" aria-hidden="true"></i></a></li>
    <li><a class="icon"
           href="https://service.weibo.com/share/share.php?url=http://theoak.online/2019/12/21/SearchEngine/&title=SearchEngine"><i
                    class="fab fa-weibo fa-lg" aria-hidden="true"></i></a></li>
    <li><a class="icon" href="https://twitter.com/share?url=http://theoak.online/2019/12/21/SearchEngine/&text=SearchEngine" target="_blank" rel="noopener"><i
                    class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
    <li><a class="icon" href="mailto:?subject=SearchEngine&body=Check out this article: http://theoak.online/2019/12/21/SearchEngine/"><i
                    class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
</ul>
        </div>

        <div id="actions-footer">
            <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i
                        class="fas fa-bars fa-lg"
                        aria-hidden="true"></i> Menu</a>
            <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i
                        class="fas fa-list fa-lg"
                        aria-hidden="true"></i> TOC</a>
            <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i
                        class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
            <a id="top" style="display:none" class="icon" href="#"
               onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg"
                                                                               aria-hidden="true"></i> Top
            </a>
        </div>

    </div>
</div>
    
    <footer id="footer">
    <div class="footer-left">
        Copyright &copy; 2020 <i class="fas fa-heart"></i>
        EricGerry
        
    </div>
    <!-- <div class="footer-right">
    <nav>
      <ul>
        
        <li><a href="/">Home</a></li>
        
        <li><a href="/archives/">Articles</a></li>
        
        <li><a href="/categories/">Category</a></li>
        
        <li><a href="/tags/">Tag</a></li>
        
        <li><a href="/about/">About</a></li>
        
        <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div> -->

    <div class="footer-custom">
        Framework by <a href="https://hexo.io" target="_blank">Hexo</a> & Theme by <a
                href="https://github.com/xuthus5/hexo-theme-cactus" target="_blank">Cactus-CN</a>
        
    </div>
</footer>
</div>
<!-- styles -->

<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">


<link rel="stylesheet" href="https://cdn.staticfile.org/justifiedGallery/3.7.0/css/justifiedGallery.min.css">

<!-- jquery -->

<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>


<script src="https://cdn.staticfile.org/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

    
<script src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script>

    <script type="text/javascript">
        $(function () {
            // copy-btn HTML
            var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
            btn += '<i class="far fa-clone"></i>';
            btn += '</span>';
            // mount it!
            $(".highlight .code pre").before(btn);
            var clip = new ClipboardJS('.btn-copy', {
                target: function (trigger) {
                    return trigger.nextElementSibling;
                }
            });
            clip.on('success', function (e) {
                e.trigger.setAttribute('aria-label', "Copied!");
                e.clearSelection();
            })
        })
    </script>


<script src="/js/main.js"></script>

<!-- search -->

</body>

</html>